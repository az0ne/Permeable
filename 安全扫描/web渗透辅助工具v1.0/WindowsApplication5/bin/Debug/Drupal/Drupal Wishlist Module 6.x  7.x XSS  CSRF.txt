Drupal Wishlist Module 6.x / 7.x XSS / CSRF

布时间: 2012-03-21 (GMT+0800)

测试方法:

@Sebug.net   dis
本站提供程序(方法)可能带有攻击性,仅供安全研究与教学之用,风险自负!1.* Advisory ID: DRUPAL-SA-CONTRIB-2012-0422.  * Project: Wishlist Module [1] (third-party module)3.  * Version: 6.x, 7.x4.  * Date: 2012-March-215.  * Security risk: Moderately critical [2]6.  * Exploitable from: Remote7.  * Vulnerability: Cross Site Scripting, Cross Site Request Forgery8. 9.-------- DESCRIPTION  10.---------------------------------------------------------11. 12.The Wishlist Module allows users to maintain shared wishlists for special13.events and holidays.14. 15.Impact:16.The module doesn't sufficiently filter user supplied text from the URL. This17.can be used to perform a reflected cross site scripting (XSS) attack. User18.account credentials could be exposed or compromised, or users could be19.redirected to sites designed for phishing or hosting malware. This20.vulnerability is mitigated by the fact that users must be tricked into21.visiting a specific link and then manipulating the show/hide purchase details22.drop down. This drop down is only rendered if the user is viewing their own23.Wish List and the module is configured to hide the purchased status from24.them.25. 26.-------- VERSIONS AFFECTED  27.---------------------------------------------------28. 29.  * Wishlist Module 6.x-2.x versions prior to 6.x-2.6.30.  * Wishlist Module 7.x-2.x versions prior to 7.x-2.6.31. 32.Drupal core is not affected. If you do not use the contributed Wishlist33.Module [3] module, there is nothing you need to do.34. 35.-------- SOLUTION  36.------------------------------------------------------------37. 38.Install the latest version:39. 40.  * If you use the Wishlist module for Drupal 6.x, upgrade to Wishlist 6.x-2.641.    [4]42.  * If you use the Wishlist module for Drupal 7.x, upgrade to Wishlist 7.x-2.643.    [5]44. 45.See also the Wishlist Module [6] project page.46. 47.-------- REPORTED BY  48.---------------------------------------------------------49. 50.  * Justin Klein Keane [7]51. 52.-------- FIXED BY  53.------------------------------------------------------------54. 55.  * Scott McLewin [8] the module maintainer56. 57.-------- COORDINATED BY  58.------------------------------------------------------59. 60.  * Greg Knaddison [9] of the Drupal Security Team61. 62.-------- CONTACT AND MORE INFORMATION  63.----------------------------------------64. 65.The Drupal security team can be reached at security at drupal.org or via the66.contact form at http://drupal.org/contact [10].67. 68.Learn more about the Drupal Security team and their policies [11], writing69.secure code for Drupal [12], and securing your site [13].70. 71. 72.[1] http://drupal.org/project/wishlist73.[2] http://drupal.org/security-team/risk-levels74.[3] http://drupal.org/project/wishlist75.[4] http://drupal.org/node/148363476.[5] http://drupal.org/node/148363677.[6] http://drupal.org/project/wishlist78.[7] http://drupal.org/user/30222579.[8] http://drupal.org/user/3371880.[9] http://drupal.org/user/3676281.[10] http://drupal.org/contact82.[11] http://drupal.org/security-team83.[12] http://drupal.org/writing-secure-code84.[13] http://drupal.org/security/secure-configuration